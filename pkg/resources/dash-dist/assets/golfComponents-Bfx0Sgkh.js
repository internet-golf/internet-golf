import{g as y,c as w}from"./session-DDv_qSEA.js";const g="/_golf",d=e=>typeof Blob<"u"&&e instanceof Blob,k=e=>!e||typeof e!="object"?!1:e instanceof FormData?!0:Object.values(e).some(t=>d(t)),b=e=>{const t=new FormData;for(const[n,o]of Object.entries(e))if(o!=null){if(d(o)){const s=o.name||"upload";t.append(n,o,s);continue}if(typeof o=="string"||typeof o=="number"||typeof o=="boolean"){t.append(n,String(o));continue}t.append(n,JSON.stringify(o))}return t};async function c({url:e,method:t,body:n,headers:o,pathParams:s,queryParams:p,signal:m}){let f;try{const r=y();r||(console.warn("no auth token found, redirecting home"),window.location.href="/");const l={"Content-Type":"application/json",...{Authorization:`Bearer ${r}`},...o},i=(()=>{if(n)return n instanceof FormData?n:k(n)?b(n):n})();(i instanceof FormData||l["Content-Type"]?.toLowerCase().includes("multipart/form-data"))&&delete l["Content-Type"];const a=await window.fetch(`${g}${D(e,p,s)}`,{signal:m,method:t.toUpperCase(),body:i?i instanceof FormData?i:JSON.stringify(i):void 0,headers:l});if(a.ok)return a.headers.get("content-type")?.includes("json")?await a.json():await a.blob();a.status===401&&(console.warn("got 401 response, erasing token and redirecting home"),w(),window.location.href="/");try{f=await a.json()}catch(u){f={status:"unknown",payload:u instanceof Error?`Unexpected error (${u.message})`:"Unexpected error"}}}catch(r){throw{name:"unknown",message:r instanceof Error?`Network error (${r.message})`:"Network error",stack:r}}throw f}const D=(e,t={},n={})=>{let o=new URLSearchParams(t).toString();return o&&(o=`?${o}`),e.replace(/\{\w*\}/g,s=>n[s.slice(1,-1)]??"")+o},F=(e,t)=>c({url:"/deploy/alias",method:"put",...e,signal:t}),T=(e,t)=>c({url:"/deploy/files",method:"put",...e,signal:t}),O=(e,t)=>c({url:"/deploy/new",method:"put",...e,signal:t}),U=(e,t)=>c({url:"/deployment/{url}",method:"delete",...e,signal:t}),C=e=>c({url:"/deployments",method:"get",signal:e});export{T as a,F as b,O as c,U as d,C as g};
