openapi: 3.0.3
info:
  title: Internet Golf API
  version: 0.5.0
servers:
- url: /
paths:
  /admin-dash:
    put:
      description: Deploy the admin dashboard to a specified URL.
      operationId: DeployAdminDash
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/DeployAdminDashBody"
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SuccessOutputBody"
          description: OK
        default:
          content:
            application/problem+json:
              schema:
                $ref: "#/components/schemas/ErrorModel"
          description: Error
  /alive:
    get:
      description: Find out if the server is up or not.
      operationId: HealthCheck
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/HealthCheckOutputBody"
          description: OK
        default:
          content:
            application/problem+json:
              schema:
                $ref: "#/components/schemas/ErrorModel"
          description: Error
  /deploy/alias:
    put:
      description: Create an alias deployment.
      operationId: CreateAlias
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/DeployAliasBody"
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SuccessOutputBody"
          description: OK
        default:
          content:
            application/problem+json:
              schema:
                $ref: "#/components/schemas/ErrorModel"
          description: Error
  /deploy/files:
    put:
      description: Put files in an existing deployment.
      operationId: DeployFiles
      requestBody:
        content:
          multipart/form-data:
            encoding:
              contents:
                contentType: "application/gzip,application/octet-stream"
                style: form
              keepLeadingDirectories:
                contentType: text/plain
                style: form
              preserveExistingFiles:
                contentType: text/plain
                style: form
              url:
                contentType: text/plain
                style: form
            schema:
              $ref: "#/components/schemas/DeployFiles_request"
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SuccessOutputBody"
          description: OK
        default:
          content:
            application/problem+json:
              schema:
                $ref: "#/components/schemas/ErrorModel"
          description: Error
  /deploy/new:
    put:
      description: Create a new deployment.
      operationId: CreateDeployment
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/DeploymentCreateInputBody"
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SuccessOutputBody"
          description: OK
        default:
          content:
            application/problem+json:
              schema:
                $ref: "#/components/schemas/ErrorModel"
          description: Error
  /deployment/{url}:
    get:
      description: Retrieve an active deployment.
      operationId: GetDeployment
      parameters:
      - explode: false
        in: path
        name: url
        required: true
        schema:
          type: string
        style: simple
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GetDeployment_200_response"
          description: OK
        default:
          content:
            application/problem+json:
              schema:
                $ref: "#/components/schemas/ErrorModel"
          description: Error
  /deployments:
    get:
      description: Retrieve all active deployments.
      operationId: GetDeployments
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GetDeployments_200_response"
          description: OK
        default:
          content:
            application/problem+json:
              schema:
                $ref: "#/components/schemas/ErrorModel"
          description: Error
  /token/generate:
    post:
      operationId: post-token-generate
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateBearerTokenInputBody"
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CreateBearerTokenOutputBody"
          description: OK
        default:
          content:
            application/problem+json:
              schema:
                $ref: "#/components/schemas/ErrorModel"
          description: Error
      summary: Post token generate
  /user/register:
    put:
      operationId: put-user-register
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AddExternalUserInputBody"
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SuccessOutputBody"
          description: OK
        default:
          content:
            application/problem+json:
              schema:
                $ref: "#/components/schemas/ErrorModel"
          description: Error
      summary: Put user register
components:
  schemas:
    AddExternalUserInputBody:
      additionalProperties: false
      example:
        $schema: https://example.com/schemas/AddExternalUserInputBody.json
        externalUserId: externalUserId
        externalUserHandle: externalUserHandle
        externalUserSource: externalUserSource
      properties:
        $schema:
          description: A URL to the JSON Schema for this object.
          example: https://example.com/schemas/AddExternalUserInputBody.json
          format: uri
          readOnly: true
          type: string
        externalUserHandle:
          type: string
        externalUserId:
          type: string
        externalUserSource:
          type: string
      required:
      - externalUserSource
      type: object
    AliasDeployment:
      additionalProperties: false
      properties:
        aliasedTo:
          description: The URL that this deployment is an alias for.
          type: string
        externalSource:
          description: Original repository for this deployment's source. Can include
            a branch name.
          example: user/repo or user/repo#branch-name
          type: string
        externalSourceType:
          description: Place where the original repository lives.
          type: string
        preserveExternalPath:
          description: "if this is true and the deployment url has a path like \"\
            /thing\", then the \"/thing\" in the path will be transparently passed\
            \ through to the underlying resource instead of being removed (which is\
            \ the default)"
          type: boolean
        redirect:
          description: "If this is true, visitors to this deployment's URL will be\
            \ completely redirected to the URL that this alias is for."
          type: boolean
        tags:
          description: Tags used for metadata.
          items:
            type: string
          nullable: true
          type: array
        type:
          description: Type of deployment contents.
          enum:
          - StaticSite
          - Alias
          - Empty
          type: string
        url:
          description: URL that this deployment will appear at. The DNS for the domain
            has to be set up first.
          example: mysite.mydomain.com
          type: string
      required:
      - type
      - url
      type: object
    CreateBearerTokenInputBody:
      additionalProperties: false
      example:
        $schema: https://example.com/schemas/CreateBearerTokenInputBody.json
        fullPermissions: true
      properties:
        $schema:
          description: A URL to the JSON Schema for this object.
          example: https://example.com/schemas/CreateBearerTokenInputBody.json
          format: uri
          readOnly: true
          type: string
        fullPermissions:
          type: boolean
      required:
      - fullPermissions
      type: object
    CreateBearerTokenOutputBody:
      additionalProperties: false
      example:
        $schema: https://example.com/schemas/CreateBearerTokenOutputBody.json
        token: token
      properties:
        $schema:
          description: A URL to the JSON Schema for this object.
          example: https://example.com/schemas/CreateBearerTokenOutputBody.json
          format: uri
          readOnly: true
          type: string
        token:
          type: string
      required:
      - token
      type: object
    DeployAdminDashBody:
      additionalProperties: false
      example:
        $schema: https://example.com/schemas/DeployAdminDashBody.json
        url: dash.mydomain.com
      properties:
        $schema:
          description: A URL to the JSON Schema for this object.
          example: https://example.com/schemas/DeployAdminDashBody.json
          format: uri
          readOnly: true
          type: string
        url:
          description: The URL that you want to deploy the admin dashboard to.
          example: dash.mydomain.com
          type: string
      required:
      - url
      type: object
    DeployAliasBody:
      additionalProperties: false
      example:
        redirect: true
        $schema: https://example.com/schemas/DeployAliasBody.json
        Url: mysite.mydomain.com
        aliasedTo: aliasedTo
      properties:
        $schema:
          description: A URL to the JSON Schema for this object.
          example: https://example.com/schemas/DeployAliasBody.json
          format: uri
          readOnly: true
          type: string
        Url:
          description: The URL of the deployment that you're updating.
          example: mysite.mydomain.com
          type: string
        aliasedTo:
          description: The URL that this deployment is an alias for.
          type: string
        redirect:
          description: "If this is true, visitors to this deployment's URL will be\
            \ completely redirected to the URL that this alias is for."
          type: boolean
      required:
      - Url
      type: object
    DeploymentCreateInputBody:
      additionalProperties: false
      example:
        $schema: https://example.com/schemas/DeploymentCreateInputBody.json
        externalSourceType: externalSourceType
        preserveExternalPath: true
        url: mysite.mydomain.com
        externalSource: user/repo or user/repo#branch-name
        tags:
        - tags
        - tags
      properties:
        $schema:
          description: A URL to the JSON Schema for this object.
          example: https://example.com/schemas/DeploymentCreateInputBody.json
          format: uri
          readOnly: true
          type: string
        externalSource:
          description: Original repository for this deployment's source. Can include
            a branch name.
          example: user/repo or user/repo#branch-name
          type: string
        externalSourceType:
          description: Place where the original repository lives.
          type: string
        preserveExternalPath:
          description: "if this is true and the deployment url has a path like \"\
            /thing\", then the \"/thing\" in the path will be transparently passed\
            \ through to the underlying resource instead of being removed (which is\
            \ the default)"
          type: boolean
        tags:
          description: Tags used for metadata.
          items:
            type: string
          nullable: true
          type: array
        url:
          description: URL that this deployment will appear at. The DNS for the domain
            has to be set up first.
          example: mysite.mydomain.com
          type: string
      required:
      - url
      type: object
    DeploymentModel:
      additionalProperties: false
      properties:
        aliasedTo:
          description: The URL that this deployment is an alias for.
          type: string
        externalSource:
          description: Original repository for this deployment's source. Can include
            a branch name.
          example: user/repo or user/repo#branch-name
          type: string
        externalSourceType:
          description: Place where the original repository lives.
          type: string
        noContentYet:
          description: Set to true to indicate that this deployment has not yet been
            set up.
          type: boolean
        preserveExternalPath:
          description: "if this is true and the deployment url has a path like \"\
            /thing\", then the \"/thing\" in the path will be transparently passed\
            \ through to the underlying resource instead of being removed (which is\
            \ the default)"
          type: boolean
        redirect:
          description: "If this is true, visitors to this deployment's URL will be\
            \ completely redirected to the URL that this alias is for."
          type: boolean
        serverContentLocation:
          description: The path to this deployment's files on the server.
          type: string
        spaMode:
          description: Whether this deployment is set up to support a Single Page
            App by using /index.html as a fallback for all requests.
          type: boolean
        tags:
          description: Tags used for metadata.
          items:
            type: string
          nullable: true
          type: array
        type:
          description: Type of deployment contents.
          enum:
          - StaticSite
          - Alias
          - Empty
          type: string
        url:
          description: URL that this deployment will appear at. The DNS for the domain
            has to be set up first.
          example: mysite.mydomain.com
          type: string
      required:
      - noContentYet
      - type
      - url
      type: object
    EmptyDeployment:
      additionalProperties: false
      properties:
        externalSource:
          description: Original repository for this deployment's source. Can include
            a branch name.
          example: user/repo or user/repo#branch-name
          type: string
        externalSourceType:
          description: Place where the original repository lives.
          type: string
        noContentYet:
          description: Set to true to indicate that this deployment has not yet been
            set up.
          type: boolean
        preserveExternalPath:
          description: "if this is true and the deployment url has a path like \"\
            /thing\", then the \"/thing\" in the path will be transparently passed\
            \ through to the underlying resource instead of being removed (which is\
            \ the default)"
          type: boolean
        tags:
          description: Tags used for metadata.
          items:
            type: string
          nullable: true
          type: array
        type:
          description: Type of deployment contents.
          enum:
          - StaticSite
          - Alias
          - Empty
          type: string
        url:
          description: URL that this deployment will appear at. The DNS for the domain
            has to be set up first.
          example: mysite.mydomain.com
          type: string
      required:
      - noContentYet
      - type
      - url
      type: object
    ErrorDetail:
      additionalProperties: false
      properties:
        location:
          description: "Where the error occurred, e.g. 'body.items[3].tags' or 'path.thing-id'"
          type: string
        message:
          description: Error message text
          type: string
        value:
          description: The value at the given location
      type: object
    ErrorModel:
      additionalProperties: false
      properties:
        $schema:
          description: A URL to the JSON Schema for this object.
          example: https://example.com/schemas/ErrorModel.json
          format: uri
          readOnly: true
          type: string
        detail:
          description: A human-readable explanation specific to this occurrence of
            the problem.
          example: Property foo is required but is missing.
          type: string
        errors:
          description: Optional list of individual error details
          items:
            $ref: "#/components/schemas/ErrorDetail"
          nullable: true
          type: array
        instance:
          description: A URI reference that identifies the specific occurrence of
            the problem.
          example: https://example.com/error-log/abc123
          format: uri
          type: string
        status:
          description: HTTP status code
          example: 400
          format: int64
          type: integer
        title:
          description: "A short, human-readable summary of the problem type. This\
            \ value should not change between occurrences of the error."
          example: Bad Request
          type: string
        type:
          default: about:blank
          description: A URI reference to human-readable documentation for the error.
          example: https://example.com/errors/example
          format: uri
          type: string
      type: object
    GetDeploymentsOutputBody:
      additionalProperties: false
      properties:
        deployments:
          items:
            $ref: "#/components/schemas/DeploymentModel"
          nullable: true
          type: array
      required:
      - deployments
      type: object
    HealthCheckOutputBody:
      additionalProperties: false
      example:
        $schema: https://example.com/schemas/HealthCheckOutputBody.json
        ok: true
      properties:
        $schema:
          description: A URL to the JSON Schema for this object.
          example: https://example.com/schemas/HealthCheckOutputBody.json
          format: uri
          readOnly: true
          type: string
        ok:
          type: boolean
      required:
      - ok
      type: object
    StaticSiteDeployment:
      additionalProperties: false
      example:
        spaMode: true
        serverContentLocation: serverContentLocation
        externalSourceType: externalSourceType
        preserveExternalPath: true
        type: StaticSite
        url: mysite.mydomain.com
        externalSource: user/repo or user/repo#branch-name
        tags:
        - tags
        - tags
      properties:
        externalSource:
          description: Original repository for this deployment's source. Can include
            a branch name.
          example: user/repo or user/repo#branch-name
          type: string
        externalSourceType:
          description: Place where the original repository lives.
          type: string
        preserveExternalPath:
          description: "if this is true and the deployment url has a path like \"\
            /thing\", then the \"/thing\" in the path will be transparently passed\
            \ through to the underlying resource instead of being removed (which is\
            \ the default)"
          type: boolean
        serverContentLocation:
          description: The path to this deployment's files on the server.
          type: string
        spaMode:
          description: Whether this deployment is set up to support a Single Page
            App by using /index.html as a fallback for all requests.
          type: boolean
        tags:
          description: Tags used for metadata.
          items:
            type: string
          nullable: true
          type: array
        type:
          description: Type of deployment contents.
          enum:
          - StaticSite
          - Alias
          - Empty
          type: string
        url:
          description: URL that this deployment will appear at. The DNS for the domain
            has to be set up first.
          example: mysite.mydomain.com
          type: string
      required:
      - type
      - url
      type: object
    SuccessOutputBody:
      additionalProperties: false
      example:
        $schema: https://example.com/schemas/SuccessOutputBody.json
        success: true
        message: message
      properties:
        $schema:
          description: A URL to the JSON Schema for this object.
          example: https://example.com/schemas/SuccessOutputBody.json
          format: uri
          readOnly: true
          type: string
        message:
          type: string
        success:
          type: boolean
      required:
      - message
      - success
      type: object
    DeployFiles_request:
      properties:
        contents:
          description: A .tar.gz that contains the files to be deployed.
          format: binary
          type: string
        keepLeadingDirectories:
          default: false
          description: "By default, if you upload a .tar.gz whose contents are all\
            \ in one folder, the contents of that folder will be used instead of the\
            \ folder itself. For example, if you upload a folder called 'dist' for\
            \ the deployment 'mysite.com', the URL of your site content will not be\
            \ at 'mysite.com/dist'. Setting this to true turns off that auto-unpacking."
          type: boolean
        preserveExistingFiles:
          description: Leave the existing files for the current deployment in place
            instead of completely replacing them.
          type: boolean
        url:
          description: The URL of the deployment that you're updating.
          example: mysite.mydomain.com
          type: string
      required:
      - url
      type: object
    GetDeployment_200_response:
      discriminator:
        mapping:
          Alias: "#/components/schemas/AliasDeployment"
          Empty: "#/components/schemas/EmptyDeployment"
          StaticSite: "#/components/schemas/StaticSiteDeployment"
        propertyName: type
      oneOf:
      - $ref: "#/components/schemas/StaticSiteDeployment"
      - $ref: "#/components/schemas/AliasDeployment"
      - $ref: "#/components/schemas/EmptyDeployment"
    GetDeployments_200_response:
      example:
        deployments:
        - spaMode: true
          serverContentLocation: serverContentLocation
          externalSourceType: externalSourceType
          preserveExternalPath: true
          type: StaticSite
          url: mysite.mydomain.com
          externalSource: user/repo or user/repo#branch-name
          tags:
          - tags
          - tags
        - spaMode: true
          serverContentLocation: serverContentLocation
          externalSourceType: externalSourceType
          preserveExternalPath: true
          type: StaticSite
          url: mysite.mydomain.com
          externalSource: user/repo or user/repo#branch-name
          tags:
          - tags
          - tags
      properties:
        deployments:
          items:
            $ref: "#/components/schemas/GetDeployment_200_response"
          type: array
