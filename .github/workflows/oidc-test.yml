name: Print and Post ID Token Variables

on:
  workflow_dispatch:

permissions:
  id-token: write
  contents: read

jobs:
  job:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/github-script@v7
        id: script
        timeout-minutes: 10
        with:
          debug: true
          script: |
            const token = await core.getIDToken('internet-golf');
            core.setOutput('NEW_TOKEN', token.trim())
      - uses: actions/checkout@v5
      - run: |
          go run misc/oidc_sink.go ${{steps.script.outputs.NEW_TOKEN}}
